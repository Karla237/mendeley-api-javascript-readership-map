"use strict";var populateDropdown=function(e){var t,r,o,n,a,i=document.getElementById("user_doc_popup");for(t=0,r=e.length,o;r>t;t+=1)if(o=e[t],o.identifiers&&(o.identifiers.arxiv&&(n="arxiv",a=o.identifiers.arxiv),o.identifiers.doi&&(n="doi",a=o.identifiers.doi)),n){var s=document.createElement("option");s.textContent=o.title,s.setAttribute("data-identifier-type",n),s.value=a,i.appendChild(s)}$("#user_doc_popup").trigger("change")},updateMap=function(e){var t,r={},o=0;$.each(e,function(e,t){if(t.reader_count_by_country)for(var n in t.reader_count_by_country)r[n]?r[n]+=t.reader_count_by_country[n]:r[n]=t.reader_count_by_country[n],o=Math.max(o,r[n])});for(var n=map.contentDocument.getElementsByClassName("land"),a=0;a<n.length;a++){var i=n[a].getAttribute("title");r[i]?(t=r[i]/o,n[a].style.fill="rgba(157, 22, 32, "+t+")"):n[a].style.fill="rgb(204,204,204)"}},errorHandler=function(e,t){var r;console.error("Request failed with status code:",t.status),t&&t.responseText?(r=JSON.parse(t.responseText),r.hasOwnProperty("message")?console.error("Response error message:",r.message):console.info("No response error message received")):console.info("No response body received")},getDocuments=function(){MendeleySDK.API.documents.list().done(populateDropdown).fail(errorHandler)},getCatalog=function(e){var t=this.selectedOptions.item(0).dataset.identifierType,r=this.value,o={};o[t]=r,o.view="stats",MendeleySDK.API.catalog.search(o).done(updateMap).fail(errorHandler),e.preventDefault()};